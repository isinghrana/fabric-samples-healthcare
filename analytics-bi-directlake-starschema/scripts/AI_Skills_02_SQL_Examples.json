{
    "Show cost per day of ace inhibitors in the state of florida for internists in the year 2020": "SELECT d.Gnrc_Name AS Drug_Generic_Name, \r\n       (SUM(c.Tot_Drug_Cst) / NULLIF(SUM(c.Tot_Day_Suply),0)) AS Cost_Per_Day \r\nFROM [dbo].[cms_provider_drug_costs_star] c\r\nJOIN [dbo].[cms_provider_dim_drug] d ON c.drug_key = d.drug_key\r\nJOIN [dbo].[cms_provider_dim_geography] g ON c.geo_key = g.geo_key \r\nJOIN [dbo].[cms_provider_dim_provider] p ON c.provider_key = p.provider_key \r\nJOIN [dbo].[cms_provider_dim_year] y ON c.[Year] = y.[Year] \r\nWHERE d.Gnrc_Name LIKE '%pril%' AND g.Prscrbr_State_Abrvtn = 'FL' AND p.Prscrbr_Type LIKE '%Internal Medicine%' AND y.[Year] = 2020 \r\nGROUP BY d.Gnrc_Name\r\nORDER BY Cost_Per_Day DESC ",
    "Show total cost percent change for 2021": "SELECT \r\n       ((SUM(CASE WHEN c.Year = 2021 THEN c.Tot_Drug_Cst ELSE 0 END) - SUM(CASE WHEN c.Year = 2020 THEN c.Tot_Drug_Cst ELSE 0 END)) / NULLIF(SUM(CASE WHEN c.Year = 2020 THEN c.Tot_Drug_Cst ELSE 0 END),0)) * 100 AS Cost_Percent_Change_2021_vs_2020\r\nFROM [dbo].[cms_provider_drug_costs_star] c",
    "Show top 10 doctors in florida for total cost of statins": "SELECT TOP 10 p.Prscrbr_Full_Name AS Doctor_Name,\r\n       p.Prscrbr_Type AS Prescriber_Type, \r\n       SUM(c.Tot_Drug_Cst) AS Total_Cost\r\nFROM [dbo].[cms_provider_drug_costs_star] c\r\nJOIN [dbo].[cms_provider_dim_drug] d ON c.drug_key = d.drug_key\r\nJOIN [dbo].[cms_provider_dim_geography] g ON c.geo_key = g.geo_key \r\nJOIN [dbo].[cms_provider_dim_provider] p ON c.provider_key = p.provider_key \r\nWHERE d.Gnrc_Name LIKE '%statin%' AND g.Prscrbr_State_Abrvtn = 'FL'\r\nGROUP BY p.Prscrbr_Full_Name,p.Prscrbr_Type\r\nORDER BY Total_Cost DESC",
    "Show top 10 doctors who have total cost change greater than 10 and total days supply change greater than 10 in 2021 versus 2020": "SELECT TOP 10 p.Prscrbr_Full_Name AS Prscrbr,\r\np.Prscrbr_Type AS Type,\r\nSUM(CASE WHEN c.Year = 2021 THEN c.Tot_Drug_Cst ELSE 0 END) AS Tot_Cost_2021,\r\nSUM(CASE WHEN c.Year = 2021 THEN c.Tot_Day_Suply ELSE 0 END) AS Tot_Day_Supply_2021,\r\nSUM(CASE WHEN c.Year = 2021 THEN c.Tot_Drug_Cst ELSE 0 END) - SUM(CASE WHEN c.Year = 2020 THEN c.Tot_Drug_Cst ELSE 0 END) AS Tot_Cst_2021_chg,\r\nSUM(CASE WHEN c.Year = 2021 THEN c.Tot_Day_Suply ELSE 0 END) - SUM(CASE WHEN c.Year = 2020 THEN c.Tot_Day_Suply ELSE 0 END) AS Tot_Day_Supply_2021_chg\r\nFROM [dbo].[cms_provider_drug_costs_star] c\r\nJOIN [dbo].[cms_provider_dim_provider] p ON c.provider_key = p.provider_key\r\nGROUP BY p.Prscrbr_Full_Name, p.Prscrbr_Type\r\nHAVING SUM(CASE WHEN c.Year = 2021 THEN c.Tot_Drug_Cst ELSE 0 END) - SUM(CASE WHEN c.Year = 2020 THEN c.Tot_Drug_Cst ELSE 0 END) > 10\r\nAND SUM(CASE WHEN c.Year = 2021 THEN c.Tot_Day_Suply ELSE 0 END) - SUM(CASE WHEN c.Year = 2020 THEN c.Tot_Day_Suply ELSE 0 END) > 10\r\nORDER BY Tot_Cost_2021 DESC",
    "Total cost for beta blockers": "SELECT \r\n       SUM(c.Tot_Drug_Cst) AS Total_Cost,\r\n       d.Gnrc_Name AS Generic_Name\r\nFROM [dbo].[cms_provider_drug_costs_star] c\r\nJOIN [dbo].[cms_provider_dim_drug] d ON c.drug_key = d.drug_key\r\nWHERE LOWER(d.Gnrc_Name) LIKE '%carvedilol%'\r\nAND d.Gnrc_Name NOT LIKE '%carvedilol%'\r\nGROUP BY d.Gnrc_Name"
}
